function jaco = jacoemcali(param,s)
% diego domenzain
% jun 2022
% ------------------------------------------------------------------------------
% d = ( l*c*s.^2 + (r*c + l/a)*s + 1 + r/a ) ./ ( l*c*s.^2 + (r*c + l/b)*s + 1 + r/b )
%
%                           Θ = || do - d ||_2^2
%                           ∇ = (∂l , ∂c)
%
% ∂l(d) = (b*s*(b - a)) ./ (a*(b*c*s*(l*s + r) + b + l*s + r)^2)
% ∂c(d) = (b*s*(a - b).*(l*s + r)^2) ./ (a*(b*c*s.*(l*s + r) + b + l*s + r)^2)
% ------------------------------------------------------------------------------
l = param(1);
c = param(2);
r = param(3);
a = param(4);
b = param(5);
% ------------------------------------------------------------------------------
ns = numel(s);
jaco = zeros(ns,2);
jaco = complex(jaco,0);
% ------------------------------------------------------------------------------
jaco(:,1) = (b*s*(b - a)) ./ (a*(b*c*s.*(l*s + r) + b + l*s + r).^2);
jaco(:,2) = (b*s*(a - b).*(l*s + r).^2) ./ (a*(b*c*s.*(l*s + r) + b + l*s + r).^2);
% ------------------------------------------------------------------------------
% jaco = real(jaco);
end
