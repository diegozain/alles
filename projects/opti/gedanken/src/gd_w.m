function [p,pp,EE,ss] = gd_w(p,s_w,Mw,d_w_o,Nw,max_iter)
% ..............................................................................
pp = p;
E_E = 1;
count_ = 0;
EE = [];
ss = [];
% ..............................................................................
while E_E > 1e-25
  % forward run & objective calculator
  %
  [u_w,e_w,Lw]    = fwd_w(p,s_w,Mw,d_w_o);
  E_E = Ew_obj(e_w,Nw);
  % ............................................................................
  % calculate & store gradient 
  % (- descent direction)
  %
  g_w = Jte_w(u_w,s_w,p,e_w,Mw,Lw);
  g_w_norm = norm(g_w);
  % ............................................................................
  % calculate step size
  %
  step_w = ( g_w_norm / norm( Jg_w(u_w,s_w,p,g_w,Mw,Lw) ) )^2;
  % ............................................................................
  % update parameter
  %
  p  = p - step_w*g_w;
  % ............................................................................
  % store for plotting
  %
  pp = [pp p];
  EE = [EE E_E];
  ss = [ss step_w];
  % ............................................................................
  count_ = count_ + 1;
  if count_ > max_iter
      break
  end
end
% ..............................................................................
end
